#!/bin/sh

# diff-s-sweet: Given two filenames
# (in s-expressions and sweet-expressions respectively),
# show the semantic differences between them.
# If there's a difference, show the difference and return an error code,
# else show nothing and return true (0).

# (C) 2013 David A. Wheeler
# Released under the MIT license

export PATH="@PATH_PREFIX@$PATH"
SWEETEN="sweeten"
UNSWEETEN="unsweeten"

if [ $# -ne 2 ] ; then
  echo "Must have exactly two arguments, but # arguments = $#"
  exit 99
fi
if [ ! -f "$1" ] ; then
  echo "File 1 must exist as a normal file"
  exit 98
fi
if [ ! -f "$2" ] ; then
  echo "File 2 must exist as a normal file"
  exit 98
fi

${SWEETEN} "$1" | ${UNSWEETEN} > ,first

${UNSWEETEN} "$2" > ,second

diff -u ,first ,second
